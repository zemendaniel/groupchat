<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:gui="clr-namespace:groupchat.gui"
        x:Class="groupchat.gui.MainWindow"
        Width="800" Height="600"
        Title="Group Chat"
        Background="Black"
        SystemDecorations="None"
        CanResize="True"
        FontFamily="{StaticResource SpaceMonoFont}">

    <Grid RowDefinitions="Auto,*">
        <Border Background="#222" Height="30" PointerPressed="TitleBar_PointerPressed">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="Group Chat" VerticalAlignment="Center" Margin="6"
                           Foreground="White" FontWeight="DemiBold"/>

                <!-- Minimize button -->
                <Button Grid.Column="1" Width="28" Height="28" 
                        VerticalAlignment="Center" HorizontalAlignment="Center"
                        Background="Transparent" BorderBrush="Transparent"
                        Click="MinimizeButtonClick" FontWeight="Bold">
                    <TextBlock Text="-" HorizontalAlignment="Center" VerticalAlignment="Center" 
                               FontSize="16" Foreground="White"/>
                    <Button.Styles>
                        <Style Selector="Button:hover">
                            <Setter Property="Background" Value="#444"/> 
                        </Style>
                    </Button.Styles>
                </Button>
                <Button Grid.Column="2" Width="28" Height="28"
                        VerticalAlignment="Center" HorizontalAlignment="Center"
                        Background="Transparent" BorderBrush="Transparent"
                        Click="CloseButton_Click">
                    <TextBlock Text="X" HorizontalAlignment="Center" VerticalAlignment="Center" 
                               FontSize="16" Foreground="White" FontWeight="Bold"/>
                    <Button.Styles>
                        <Style Selector="Button:hover">
                            <Setter Property="Background" Value="#444"/> 
                        </Style>
                    </Button.Styles>
                </Button>
                
            </Grid>
        </Border>

        <!-- Main content -->
        <Grid Grid.Row="1">
            <!-- Startup Panel -->
            <StackPanel x:Name="StartupPanel" VerticalAlignment="Center" HorizontalAlignment="Center" IsVisible="True">
                <TextBlock Text="Enter your nickname:" Foreground="White" Margin="5" HorizontalAlignment="Center"/>
                <TextBox x:Name="NicknameBox" HorizontalContentAlignment="Center" MaxLength="32" Width="310" 
                         Margin="0, 5, 0, 30" Background="Black" Foreground="White" HorizontalAlignment="Stretch"
                         KeyDown="NicknameBox_OnKeyDown"
                         />
                
                <TextBlock Text="Select network adapter:" HorizontalAlignment="Center" Margin="0, 0,0,10" Foreground="White"/>
                <ComboBox x:Name="AdapterComboBox"
                          Width="750"
                          Background="Black"
                          Foreground="White"
                          HorizontalContentAlignment="Center">
                    <ComboBox.HorizontalAlignment>Center</ComboBox.HorizontalAlignment>
                    <ComboBox.Styles>
                        <Style Selector="ComboBoxItem">
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        </Style>
                    </ComboBox.Styles>
                </ComboBox>                
                <Button Content="Start Chat" Click="StartChat_Click" HorizontalAlignment="Center" Margin="0,20,0,0"/>
            </StackPanel>
            
            <Grid x:Name="ChatPanel" Margin="0,0,0,5" IsVisible="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>   
                    <RowDefinition Height="Auto"/> 
                </Grid.RowDefinitions>

                <ScrollViewer Grid.Row="0"
                              x:Name="MessagesScrollViewer"
                              Background="Black"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Margin="3">
                    <ItemsControl x:Name="MessagesList"
                                  Background="Black"
                                  Foreground="White"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </ScrollViewer>

                <TextBox Grid.Row="1"
                         x:Name="InputBox"
                         Height="100"
                         MaxLength="900"
                         Width="780"
                         Watermark="Type here to send messages and press enter to send..."
                         Background="Black"
                         Foreground="White"
                         HorizontalAlignment="Stretch"
                         VerticalAlignment="Bottom"
                         Margin="3"
                         KeyDown="InputBox_OnKeyDown"/>
                
            </Grid>
        </Grid>
    </Grid>

    <Window.DataTemplates>
        <DataTemplate DataType="{x:Type gui:ChatMessage}">
            <StackPanel Margin="2">
                <TextBlock Text="{Binding Text}" Foreground="{Binding Color}" TextWrapping="Wrap"/>
            </StackPanel>
        </DataTemplate>
    </Window.DataTemplates>
</Window>
